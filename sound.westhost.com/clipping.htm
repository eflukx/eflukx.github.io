<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<meta name="Author" content="Rod Elliott - Elliott Sound Products">
	<meta name="description" content="Power amplifier clipping behaviour - all is not what it seems.">
	<!-- Power amplifier clipping behaviour - all is not what it seems. -->
	<meta name="keywords" content="power,amplifier,clipping,audio,diy,fi-fi,electronic">
	<title>Power Amplifier Clipping</title>
	<link rel="StyleSheet" href="esp.css" type="text/css" media="screen, print">
	<link rel="shortcut icon" type="image/ico" href="favicon.ico">
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000EE" vlink="#551A8B" alink="#FF0000">
<table width="100%"><tr><td><img SRC="esp.jpg" alt="ESP Logo" height=81 width=215>
<td align="right">

<script type="text/javascript"><!--
google_ad_client = "pub-1947877433449191";
/* 468x60, created 20/08/10 */
google_ad_slot = "7119701939";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

</table>

<table WIDTH="100%" BGCOLOR="blue"><tr><td class="hdrl">&nbsp;Elliott Sound Products</td>
<td ALIGN=RIGHT class="hdrr">Power Amplifier Clipping&nbsp;</td></tr></table>

<p align="center"><small>Copyright &copy; 2004 - Rod Elliott (ESP)<br>
Page Created 13 Oct 2004</small></p>

<!-- AddThis Button BEGIN -->
<script type="text/javascript">
var addthis_config = {
    data_track_clickback: true
}
</script>

<script type="text/javascript">var addthis_config = {"data_track_clickback":true};</script>
<div class="addthis_toolbox addthis_default_style">
<a href="http://addthis.com/bookmark.php?v=250&amp;username=rode" class="addthis_button_compact">Share</a>
<span class="addthis_separator">|</span>
<a class="addthis_button_facebook"></a>
<a class="addthis_button_myspace"></a>
<a class="addthis_button_google"></a>
<a class="addthis_button_twitter"></a>
</div>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#username=rode"></script>
<!-- AddThis Button END -->

<hr><a href="articles.htm"  OnMouseOver="document.t1.src='a.gif';"  OnMouseOut="document.t1.src='a1.gif';">
 <img SRC="a1.gif" NAME="t1" alt="Atricles" BORDER=0></a> <b>Articles Index</b>
<br><a href="index2.html"  OnMouseOver="document.t2.src='a.gif';" OnMouseOut="document.t2.src='a1.gif';">
 <img SRC="a1.gif" NAME="t2" alt="Index" BORDER=0></a><b>Main Index</b><br><br>

<hr><b>Contents</b>
<ul>
<li><a href="#s10">1.0 &nbsp;Introduction</a></li>
<li><a href="#s20">2.0 &nbsp;Description</a><ul>
  <li><a href="#s21">2.1 &nbsp;Test Results</a></li>
  <li><a href="#s22">2.2 &nbsp;Sources of Asymmetrical Waveforms</a></li>
  <li><a href="#s23">2.3 &nbsp;Other Issues</a></li></ul></li>
<li><a href="#s30">3.0 &nbsp;Conclusion</a></li>
<li><a href="#s40">4.0 &nbsp;Acknowledgments &amp; References</a></li>
</ul>

<hr><a id="s10"></a><b>1.0 - Introduction</b>
<p>Although it is recognised that a power amplifier should never be subjected to (overload) clipping, it is equally well recognised that it will happen at some stage. This article will explain how different amplifiers have different characteristics in this area, and the explanations that follow may go some way to showing how some amps <i>can</i> sound very different from others when subjected to overload.</p>
<p>First, we need to know what overload clipping actually is. An amplifier is said to be clipping when the output signal attempts to exceed the supply voltage. Since the supply voltage defines the absolute maximum peak output voltage from the amp, the signal will be clipped or 'cut off' if the input signal level is too high. For normal testing purposes, a sinewave is the most common test signal used, but this only tells part of the story.</p>
<p>A great deal of normal programme material is asymmetrical - it has peaks in one direction that are not duplicated in the other. Because of the signal processing used in the recording chain (including the microphone), the signal always has an effective long term DC level of zero volts, and no normal audio recorder or reproducer is expected to be able to handle a DC voltage. Short term deviations from the zero volts DC level are not uncommon, but can hardly be called 'DC' unless they are of long enough duration to cause a subsonic (in this case less than 1Hz) level shift.</p>
<p>Since it is very rare indeed that anything is recorded below about 16Hz, there is no apparent need for any reproducer to go any lower than that. The reality is that preamps and power amps will often have a -3dB frequency that is much lower than expected, with figures as low as 1Hz being common. I normally aim for around 7Hz in my designs, but even there you may find exceptions.</p>
<p>The following article applies to amplifiers used in any audio application - hi-fi, studio monitoring, professional sound reinforcement systems (live sound PA), or general purpose public address as used in buildings. Each application will present its own set of problems - the amplifier may be driving loudspeakers directly (multi-amping), or there may be transformers involved (electrostatic loudspeakers or building PA systems). In some cases tweeters and midrange drivers will be protected by series capacitance, while in other cases they may also be at risk from DC or very low frequency signals.</p>

<hr><b><a id="s20"></a>2.0 - Description</b>
<p>Within The Audio Pages, you will find several descriptions of amplifier overload, clipping recovery times, and various other associated topics (including <a href="tweeters.htm" target="_blank">Why do Tweeters Blow</a>). This article concentrates on something very different, and a specific part of the topic that is not well covered elsewhere. In this case, it is the behaviour of the amplifier when clipping is asymmetrical - not because of the amplifier, but because of the applied signal.</p>
<p>Figure 2.1 shows the amplifier used for these simulations - there is a remarkable similarity to the P3A, however 'ideal' current sources were used where appropriate. This does not change anything in the simulations. Any amplifier from any manufacturer will do exactly the same given the test conditions described below. The behaviour described is not a function of the amplifier topology, only a function of the DC response. Valve (tube) amplifiers may generally be excluded - with reservations (see Conclusion below).</p>

<p align="center"><img src="clip-f21.gif" alt="Fig 2.1" border="1" /><br /><small><b>Figure 2.1 - Test Amplifier Circuit Diagram</b></small></p>

<p>The important parts of the above diagram are the input coupling cap and resistor, the feedback resistors and capacitor, and the final filter network used to isolate the DC component of the signal. It may also be said that the simulations that follow are by no means the 'worst case' ... any real signal may have far greater effect than that shown.</p>

<p align="center"><img src="clip-f22.gif" alt="Fig 2.2" border="1" /><br /><small><b>Figure 2.2 - (Raw) Input Waveform</b></small></p>

<p>The composite input signal is made up of a 3.3V peak-to-peak sinewave at 1kHz, added to a 2kHz 3.3V P-P sinewave whose phase is shifted by 90&deg; to obtain an asymmetrical waveform that has a peak amplitude that is almost twice as great in the negative direction as in the positive direction. The DC component of this waveform is zero - the area of waveform above the zero volt line exactly equals that below, so the net DC must be zero (the simulator claims 3.15mV, but this is insignificant, and is simply the result of the simulator sampling rate).</p>
<p>The input waveform shown above is a bit nasty from the simulator's perspective, so a small delay was introduced to ensure that the signal started at exactly zero Volts. This can be seen in the displays below, where there is a 916.6us gap at the beginning to ensure that the input to the amplifier commenced at the 0V level. To do otherwise skews the results and makes it look a lot worse than it really is. It is also unrealistic, since no music signal can start from other than a zero reference voltage.</p>
<p>Before we continue, it is important to understand just <i>how</i> clipping the waveform can introduce a DC voltage. First, look at the basic waveform details (two complete cycles are shown), both before and after it is clipped ...</p>

<p align="center"><img src="clip-f23.gif" alt="Fig 2.3" border="1" /><br /><small><b>Figure 2.3 - Input Waveform Detail</b></small></p>

<p>The total shaded area shows that the area above the zero volt line is exactly equal to the area below, therefore, the signal is perfectly balanced and there is no DC at all. When the amplifier chops off (clips) the section below the line marked 'Clipping Level', the two areas are no longer the same - the area in the lower part of the waveform is smaller because some of it has been removed when the amplifier overloads. Since the upper (positive) section of the waveform now has more area than the lower (negative) section, the overall waveform has a positive bias - this is seen as a DC voltage. No tricks, no special effects, just plain old physics at its most basic level.</p>
<p><small><b>Note:</b> - Although it may not <i>appear</i> to be the case that the areas above and below the zero volt line are equal, any apparent deviation is the result of conversion of the waveform to an image suitable for publication. Even so, you are welcome to count the pixels if you wish - you will find that the two sections are remarkably similar.</small></p>
<p>Any amplifier that has full gain at DC will present this instantaneous DC level to the loudspeaker, but it will be shown that an amp that does not extend to DC will eventually average out the DC component, reducing it to a subsonic signal with peak levels that are (hopefully) non-damaging to the loudspeaker. What is <i>not</i> shown is the recovery time (after the amplifier stops clipping), where it is understood that a non DC amplifier will produce a subsonic signal that has an equivalent amplitude but opposite polarity of that created when the clipping was present. I shall leave this as an exercise for the reader.</p>
<p>In all descriptions that follow, it is assumed that the amplifier is driving the loudspeaker directly (not using a passive crossover network). While the caps in a passive crossover will save the mid and tweeter drivers from being subjected to the DC, the woofer will still be affected, <i>regardless of the frequency that clips</i>.</p>

<hr><b><a id="s21"></a>2.1 - Test Results</b>
<p>Referring to the schematic above, the 1uF capacitor is the input cap. This ensures that any DC applied to the input cannot be amplified, and protects the speakers from DC introduced by the preamp or signal source. The -3dB frequency of the input cap and associated 22k resistor is 7.2Hz.</p>
<p>The 22uF cap is the feedback capacitor - when in place, the amp's gain will also be 3dB down at 7.2Hz. This capacitor ensures that the amplifier can have a maximum gain of unity for a DC input (including offset from the input long-tailed pair). With both capacitors in place, the -3dB frequency is 11Hz, and is about 1dB down at 20Hz.</p>
<p>Note that in the diagrams below, the charts only show the response obtained out to 20ms, but measurements were taken to 100ms of the waveform. The relatively slow rise of the DC component of the output is caused by the integrating filter (1.5k resistor and 10uF capacitor), but this was essential so that the DC levels could be seen easily. In all cases, the red trace shows the clipped output signal, and the green trace shows the DC component of the output. The clipping is easily seen - the bottom of the waveform is flat, and no longer looks like the input signal shown in Figure 2.2.</p>

<p><b>AC Coupled</b> - When the amp is completely AC coupled (having the input cap and the feedback cap installed), the clipping waveform shows that the peak DC voltage across the loudspeaker is 1.93V at 20ms, rapidly falling to 540mV at 100ms, and settling to the steady state value of 257mV after about 150ms. While this is not especially desirable, it is considerably better than the alternatives that follow. The AC coupling throughout ensures that significant DC levels can never appear across the voicecoil for any appreciable period of time.</p>

<p align="center"><img src="clip-f211.gif" alt="Fig 2.1.1" border="1" /><br /><small><b>Figure 2.1.1 - Output Signal and DC Voltage (AC Coupled)</b></small></p>

<p>With the above, we can expect to see the cone move a little when the signal is first applied at a level sufficient to cause the degree of clipping shown. It will quickly settle back to normal, and the audible effect will be that of a slightly clipped signal only.</p>

<p><b>AC Coupled (Input Only)</b> - Leaving the input capacitor in place and removing (shorting out) the feedback capacitor, the amplifier is now DC coupled from the input stage onwards. After 20ms, there is 2.7V DC output, rising to 3.8V at 100ms. Note that making the amplifier responsive to DC ensures that there <i>will</i> be DC applied to the loudspeaker if the amp is allowed to clip - even briefly.</p>

<p align="center"><img src="clip-f212.gif" alt="Fig 2.1.2" border="1" /><br /><small><b>Figure 2.1.2 - Output Signal and DC Voltage (DC Coupled with Input Cap)</b></small></p>

<p>In this case, when the signal is applied and the amplifier clips, the cone will be seen to move (outwards if polarity is normal). While nearly 4V DC will cause a problem with a woofer, the effect with a direct coupled midrange (having relatively little cone excursion and using an active crossover) will be a disaster. You can expect the loudspeaker to distort badly - adding to the distortion already created by the amplifier. To explain the reason that using only an input cap will alleviate the problem marginally (compared to the fully DC coupled case) requires a brief explanation ...</p>
<p>When an amplifier clips, it is no longer a linear system for the duration of the clipping, and the feedback circuit is inoperable. The input stage is also no longer linear, and a small amount of rectification of the input signal takes place. <i>This changes the voltage at the base of the input transistor</i>. In the case shown above, the average voltage on the base of the input transistor (Q1) changed from around -32mV at idle, to  -34mV after 20ms and -35mV after 100ms - nowhere near enough to correct the problem, but noticeable nonetheless. Be aware that this will not occur with all amp input stage topologies - some will never rectify the signal, regardless of input level or output distortion. As is to be expected, the average DC voltage at the base of the feedback transistor (Q2) follows that of the output, but attenuated by the ratio of the feedback resistors (voltage gain at all frequencies is 23).</p>

<p><b>DC Coupled</b> - With a completely DC coupled amplifier (having neither the input cap nor the feedback cap), the situation is made even worse. The effective DC voltage presented to the loudspeaker load is 3.5V after 20ms, rising to 4.4V at 100ms. Although the voltage with this waveform will not get a great deal worse than measured, there are some waveforms that can easily impress up to 15V DC onto the voicecoil - this is likely to push the coil so far out of the gap that gross intermodulation distortion will occur in the loudspeaker, adding to the harmonics generated by the amplifier clipping.</p>

<p align="center"><img src="clip-f213.gif" alt="Fig 2.1.3" border="1" /><br /><small><b>Figure 2.1.3 - Output Signal and DC Voltage (DC Coupled)</b></small></p>

<p>This is obviously the worst possible scenario - loudspeaker distortion will be very high indeed, and it is doubtful that even woofers (including long-throw subs) will be able to cope. This is especially true if the waveform is less 'friendly' than the one used for these simulations.
<p>Especially for those who consider capacitors in the audio circuit to be an "abomination", it's easy to see that the effects of the cap(s) will be far less intrusive than DC into the speaker's voicecoil. In short, it is <i>absolutely essential</i> that DC is blocked within the audio path.</p>

<p align="center"><img src="clip-f214.gif" alt="Fig 2.1.4" border="1" /><br /><small><b>Figure 2.1.4 - Method of Decreasing Response Time of Feedback Circuit</b></small></p>

<p>The arrangement shown above can be used if you expect your power amp to be pushed into clipping. By adding a resistor from the output directly to the feedback cap, the time constant is reduced, and any DC is "neutralised" somewhat faster than normal. With the conventional feedback network, the cap must charge through both feedback resistors - a total of 23k.  By adding the extra resistor, the cap's value will need to be increased, but the end result is still a faster recovery from "transient DC" events. See the following table ...</p>

<table align="center" border=1 style="border-collapse: collapse" width="506">
<colgroup span=4 width="25%">
<tr><td><td><b>Peak Voltage</b><td><b>Time to Peak</b><td><b>Volts at 1s</b>
<tr><td><b>Normal</b><td>1.93 V<td>20 ms<td>257 mV
<tr><td><b>Added R</b><td>1.61 V<td>16 ms<td>151 mV
</table>

<p>Note that in both cases, the DC voltage does not drop to zero. This is because the amplifier still has a small DC gain - namely unity. The extra resistor does reduce the DC gain a little, but the effect is not great (1.04 down from 1.13). It would be necessary to add an output capacitor to completely remove the DC, but this would be a retrograde step. While the above trick seems useful, in reality I wouldn't recommend it. The feedback cap has to be much larger than normal, and also has more signal current through it than desirable, and this will probably introduce measurable distortion. Since it's only useful when the amp clips - a condition that should be avoided whenever possible - the benefit of the extra circuitry is dubious at best.
<p>The feedback bypass resistor (for want of a better name) can be increased in value, but the end result will remain similar to that shown. With 1k as shown, dissipation is a little over 1W at clipping level with the supply voltages as indicated. Lower supply voltages will result in lower dissipation and vice versa.</p>

<hr><b><a id="s22"></a>2.2 - Sources of Asymmetrical Waveforms</b>
<p>Most people probably tend to think that their music signal is relatively symmetrical, and this is usually true when averaged out over a long period (perhaps 30 seconds or more). However, there are a great many sources of asymmetry within the programme material itself, and these include ...</p>

<ul><li>Human voice (spoken or singing)</li>
<li>Wind instruments (flute, horns, reed instruments, etc.)</li>
<li>Plucked and struck stringed instruments (guitar, harp, piano, bass, etc.)</li></ul>

<p>This list is not extensive, but covers the major 'culprits' - there are obviously many others such as drums of all kinds, synthesisers or other electronic sources, and not all notes or tones will be asymmetrical. In fact, any instrument may be symmetrical or asymmetrical depending on how it is played, the note being played, specific fingering techniques, etc. The averaging effects of a large orchestral ensemble will tend to create an overall symmetrical waveform in the long term, but there are many periods where a solo of any instrument will be not only highly asymmetrical, but made louder in the mix to even out the sound level (compression).</p>
<p>Suffice to say that in any given piece of recorded music, it is almost a given that there will be periods of sufficient level and asymmetry to cause the problems indicated above if the amplifier is overdriven - the polarity of the asymmetry will vary as well, and often even within a relatively short period.</p>
<p>Any amplifier that is driven to even mild clipping will show the effects described, depending on whether it is AC or DC coupled. DC servo systems will not be fast enough to remove the DC component - these are usually made with rather long time constants to prevent the servo from interacting with the music material, and may actually make matters worse with some signals.</p>
<p>The signal I used for these simulations is relatively benign - there are a great many signals that could be used that would give far more dramatic results, but I elected to use a reasonably realistic signal without pushing the limits. In reality, the signal I used is reasonably typical, but of course there will be signals that are a great deal worse (either by accident or design).</p>

<hr><b><a id="s23"></a>2.3 - Other Issues</b>
<p>Apart from the possibility of the DC component causing gross loudspeaker distortion, in extreme cases it may also cause the amplifier's DC protection circuitry to operate. I have heard of some amplifiers that 'solve' this problem by setting a high detection threshold for their DC detection circuitry - it may be as high as 20V for a high powered amplifier. While this prevents 'false tripping' of the protection circuit, it also reduces the level of protection offered.</p>
<p>Given the right (or wrong) signal and sufficient clipping, there is the real risk that a loudspeaker driver may even be damaged. The voicecoil may be slammed into the rear polepiece of the magnetic circuit, suspensions may be stretched and the assembly's alignment compromised. This will lead to eventual driver failure.</p>
<p>While so far I have only mentioned conventional cone loudspeakers, the situation is made a great deal worse if there is a transformer used at the amplifier output - either to drive an Electrostatic Loudspeaker (ESL) or a 70V or 100V public address distribution system. In either of these cases, the DC that flows in the low resistance primary winding of the transformer may even cause amplifier failure, not to mention gross distortion (again) because of transformer core saturation.</p>

<hr><b><a id="s30"></a>3.0 - Conclusion</b>
<p>There is no doubt that a clipped asymmetrical waveform will generate a DC component in the output of an amplifier. There is equally no doubt (as evidenced above) that a fully DC coupled power amp is the worst possible case. Since there is no requirement whatsoever for an audio amplifier to reproduce DC, it follows that designs that are fully DC coupled are of no benefit to the listener, and indeed may cause far greater problems than they are supposed to 'solve' (according to those who insist that DC reproduction is somehow 'better').</p>
<p>Wherever possible, amplifiers should never be allowed to clip - this much is well known to anyone who is interested in quality reproduction. That it very likely will happen at some point is also accepted - parties in particular being the worst offenders. For those who use relatively small (i.e. low powered) amplifiers as a matter of course, the risk is greater, although the DC voltages so created are also reduced because of the lower overall supply voltage.</p>
<p>For those who prefer valve (tube) amplifiers, they are only partially immune from this problem. Since transformers cannot pass DC by their very nature, the DC cannot get to the voicecoil. There is still the real risk that distortion will increase dramatically if an asymmetrical waveform causes amp clipping, since it is now the output transformer that takes the burden of the DC ... this may cause core saturation. The problem will be worse with push-pull amplifiers, and their distortion could easily rise to the levels commonly found in single-ended designs.</p>
<p>As noted, for power amplifiers used to drive a transformer, the DC component is even more of a problem. A typical transformer for these applications may have a primary resistance of well under 1 ohm, so even a small DC level will cause a very high current to flow.  This will cause transformer saturation and possibly amplifier failure.
<p>To what extent have the effects described here influenced reviewers (who typically never use any instrumentation, and usually never know if the amp under test is clipping or not)? I have no idea, but it is not unreasonable to assume that some degree of clipping <i>must</i> be experienced from time to time, and that <i>will</i> affect the outcome of a subjective test ... but with absolutely no technical detail to indicate the actual cause of the problem should it exist. Reviewer-speak will obfuscate the real issue(s), and the lack of instrumentation leaves us in the dark.</p>
<p>Finally, it must be pointed out that this shows that clipping with real-world (speech or music) signals creates not only the harmonics that have been described in innumerable web pages, but also generates a subsonic signal that is potentially very damaging to drivers, but is never mentioned. This signal has the capability to cause driver damage at worst, or unwanted cone modulation and additional loudspeaker distortion at best - neither can be considered a desirable outcome.</p>
<p>The moral of the story is to avoid clipping at all times - even momentary (supposedly inaudible) clipping will generate an unwanted low frequency or subsonic signal whose frequency will be completely unrelated to anything in the programme material. All it will achieve is cone displacement and increased intermodulation distortion.</p>

<hr><b><a id="s40"></a>4.0 - Acknowledgments &amp; References</b>
<p>There is really only one primary reference that is pertinent to the facts here, and I was alerted to it by a contributor (Phil Allison, who has also had some direct conversations with me on the subject). I considered the topic both interesting and important enough to put this information together, in the hope that disinformation and incorrect data elsewhere may be dispelled. The effect is real, is easily measured or simulated, and should be far better known than seems to be the case at present. It is no longer possible to see the debate that started it all, since the newsgroup archive has been deleted.</p>
<p>To obtain an understanding of other effects that asymmetrical waveforms can influence (and also showing a waveform vastly more asymmetrical that the one I used here), see <a href="http://tonnesoftware.com/appnotes/allpass/allpass.html" target="_blank">Allpass Networks in a speech chain</a> by James L. Tonne.</p>

<hr />
<center>&nbsp;
<script type="text/javascript"><!--
google_ad_client = "pub-1947877433449191";
/* 468x60, created 20/08/10 */
google_ad_slot = "7119701939";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>

<hr><a href="articles.htm"  OnMouseOver="document.b1.src='a.gif';" OnMouseOut="document.b1.src='a1.gif';">
 <img SRC="a1.gif" NAME="b1" alt="Articles" BORDER=0></a><b>Articles Index</b>
<br><a href="index2.html" OnMouseOver="document.b2.src='a.gif';" OnMouseOut="document.b2.src='a1.gif';">
 <img SRC="a1.gif" NAME="b2" alt="Index" BORDER=0></a><b>Main Index</b><br><br>

<table border bgcolor="black">
<tr><td class="t-wht"><a id="copyright"></a><b>Copyright Notice.</b> This article, including but not limited to all text and diagrams, is the intellectual property of Rod Elliott, and is Copyright &copy; 2004. Reproduction or re-publication by any means whatsoever, whether electronic, mechanical or electro- mechanical, is strictly prohibited under International Copyright laws. The author (Rod Elliott) grants the reader the right to use this information for personal use only, and further allows that one (1) copy may be made for reference. Commercial use is prohibited without express written authorisation from Rod Elliott.</td>
</tr></table>
<div class="t-sml">Page created and copyright &copy; 13 Oct 2004./ Updated 25 Nov 2008 - added "feedback bypass" resistor text and drawing.</div>
</body>
</html>
