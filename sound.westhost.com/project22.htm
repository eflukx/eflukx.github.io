<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<meta name="Author" content="Rod Elliott">
	<meta name="description" content="ESP Project Pages - Audio Test Oscillator. Visit my other pages for more test equipment and audio projects">
	<meta name="keywords" content="audio, project, diy, amp, preamp, crossover, test, power, supply, circuit, schematic, diagram, wien, wein, bridge, oscillator">
	<title>Audio Test Oscillator</title>
	<link rel="StyleSheet" href="esp.css" type="text/css" media="screen, print">
	<style TYPE="text/css"><!-- td { font-size: 10pt } --> </style>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000EE" vlink="#551A8B" alink="#FF0000">
<table width="100%"><tr><td><img SRC="esp.jpg" alt="ESP Logo" height=81 width=215>
<td align="right">

<script type="text/javascript"><!--
google_ad_client = "pub-1947877433449191";
/* 468x60, created 20/08/10 */
google_ad_slot = "7119701939";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

</td></table>

<table WIDTH="100%" BGCOLOR="blue">
<tr><td class="hdrl">&nbsp;Elliott Sound Products</td>
<td ALIGN=RIGHT class="hdrr">Project 22&nbsp;</td>
</tr></table>

<p align="center"><b>Audio Test Oscillator</b><br>
<small>Design By Rod Elliott - ESP</small></p>

<!-- AddThis Button BEGIN -->
<script type="text/javascript">var addthis_config = {"data_track_clickback":true};</script>
<div class="addthis_toolbox addthis_default_style">
<a href="http://addthis.com/bookmark.php?v=250&amp;username=rode" class="addthis_button_compact">Share</a>
<span class="addthis_separator">|</span>
<a class="addthis_button_facebook"></a>
<a class="addthis_button_myspace"></a>
<a class="addthis_button_google"></a>
<a class="addthis_button_twitter"></a>
</div>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#username=rode"></script>
<!-- AddThis Button END -->

<hr><b>Introduction</b>
<p>As a piece of test equipment, an audio oscillator has to be considered essential for anyone working in with hi-fi gear. Together with an audio millivoltmeter (as described in <a href="project16.htm">Project 16</a>), and even better if you have access to an oscilloscope, you will be able to make proper measurements on everything from preamps, RIAA equalisation stages (for vinyl disks), tone controls, crossover networks, etc.

<p>I have several, and could not verify any of my circuits without them.</p>

<p><small><b>Before embarking on this project, please see the article on <a href="articles/sinewave.htm" target="_blank">Sinewave Generation Techniques</a>. This has a lot of additional information - far more than most of the other material you'll find on-line. Many of the examples shown have been built and tested, and others have been simulated to verify that they work as claimed.</b></small></p>

<hr><b>Design Considerations</b>
<p>Normally when I design something, I try to stay away from hard-to-get parts, because if they are hard for me to get, they will probably be a lot harder for many of my readers.</p>
<p>This poses a problem with this project, because one of the essential items is a rather obscure thermistor. This is used in the gain stabilisation circuit, and as this is an absolute requirement for a sine-wave oscillator, poses something of a problem.</p>
<p>As a result, I was going to show three different ways to achieve (more or less) the same performance. Since there has been no request for the LDR stabilised version, it is on permanent hold. Of the two remaining, at least one is sure to be available, so no-one should be unable to build the unit. In this first version of the project, I will show the preferred option using the lamp stabilised circuit.</p>
<p>As with the audio millivoltmeter, it is not possible to use a standard opamp for the oscillator, because of the frequency response needed. A different variation of a discrete opamp is used for this design, using commonly available bipolar transistors.</p>
<p>Note that calibration of an oscillator is never easy if you do not have access to a frequency counter.</p>

<hr><b>Basic Principles</b>
<p>An oscillator is simply an amplifier whose positive feedback is greater than the negative feedback, resulting in a signal which is amplified over and over again (by the same amplifier) until the output can increase no further.</p>
<p>This generally results in a square wave if the frequency of oscillation is low enough relative to the amplifier's bandwidth. There are several things that must be done in order to create a usable audio oscillator:</p>

<ul>
  <li>The frequency must be defined with a suitable filter, so the output will be at a known frequency</li>
  <li>The gain must be stabilised to exactly that value which will sustain oscillation, without dying away or becoming a square wave (or just distorting)</li>
  <li>The frequency response of the amplifier should be considerably greater than the highest frequency to be generated to ensure amplitude stability at all frequencies</li>
  <li>Output impedance must be low enough to ensure that there is no significant loading from the input circuitry of any expected load</li>
  <li>An output attenuator is needed so that a defined level can be preset, preferably without having to measure it before use</li>
  <li>Ideally, a square wave output should also be provided - this is only really useful if the user has access to an oscilloscope</li>
</ul>

<p>The choice of filter circuit is discussed below, as is the stabilisation process.</p>
<p>The design presented will provide sine wave signals of typically less than 0.1% distortion from 15Hz to 150kHz, in four overlapping ranges. An optional square wave generator is also shown, and may be included if you have a use for it.</p>
<p>The oscillator is designed to operate using the AC "plug-pack" power supply described in <a href="project05.htm">Project 05</a>, since this is simple and safe. The output level is adjustable in 20dB steps, from a maximum of +10dBV down to -50dBV in 4 ranges as shown in Table 1, with a variable control to enable any desired voltage from 0V up to the maximum.</p>

<table width=640 border=1 style="border-collapse: collapse" align="center">
<colgroup span=5 width="20%">
<tr><td><b> Range in dB</b></td>
<td><b> Voltage (RMS)</b></td><td><b> Range</b></td><td><b> Lower Frequency</b></td><td><b> Upper Frequency</b></td></tr>
<tr><td> -50</td><td> 3.16 mV</td><td> 1</td><td> 15 Hz</td><td> 160 Hz</td></tr>
<tr><td> -30</td><td> 31.6 mV</td><td> 2</td><td> 150 Hz</td><td> 1,600 Hz (1.6 kHz)</td></tr>
<tr><td> -10</td><td> 316 mV</td><td> 3</td><td> 1,500 Hz</td><td> 16,000 Hz (16 kHz)</td></tr>
<tr><td> +10</td><td> 3.16 V</td><td> 4</td><td> 15,000Hz</td><td> 160,000 Hz (160kHz)</td></tr><tr>
<td colspan="2"><center><b>Table 1 - Output Level Settings</b></center></td>
<td colspan="3"><center><b>Table 2 - Frequency Range Settings</b></center></td>
</tr></table>

<p>Table 2 shows the frequency ranges available, and this is generally sufficient to cover the vast majority of likely applications.

<hr><b>Oscillator Types</b>
<p>There are many different types of oscillator, but the one almost universally used for audio work is the Wien Bridge (also called Wein Bridge). This is chosen because of its stability, relatively low distortion and ease of tuning. The basic arrangement of the Wien Bridge circuit is shown in Figure 1.

<p>The bridge is not really a filter as you would normally expect, but is a phase shift network (also known as an all-pass filter). Another way of looking at it is as a high-pass filter followed by a low-pass filter. Although it does have a bandpass response, the tuning circuit has a very low Q, and does little to attenuate harmonics.</p>

<p align="center"><img SRC="p22_fig1.gif" ALT="Figure 1" BORDER=1>
<br><b><small>Figure 1 - The Wien Bridge Basic Circuit</small></b></p>

<p>In the above circuit, R1=R2 and C1=C2. Frequency of oscillation (f<sub>o</sub>) for the lowest range is ...</p>

<blockquote>f<sub>o</sub> = 1 / (2 * Pi * (R1 * C1)) = 1 / (2 * Pi * (11,000 * 1 *10<sup>-6</sup>)) (at maximum pot resistance)
<br>f<sub>o</sub> = 1 / (2 * 3.141 * (11 * 10<sup>3</sup> * 1 * 10<sup>-6</sup>) = 1 / (6.282 * (0.011)) = 1 / 0.069
= 14.4 Hz (R1 and R2 at maximum)
<br>f<sub>o</sub> = 1 / (2 * 3.141 * (1 * 10<sup>3</sup> * 1 * 10<sup>-6</sup>) = 1 / (6.282 * (1 * 10<sup>-3</sup>)) = 1 / 6.28 * 10<sup>-3</sup> = 159 Hz (R1 and R2 at minimum)</blockquote>

<p>Other ranges are simply multiples of the above, and as can be seen this is very close to the specification shown above. Since the maximum capacitance needed is 1uF (the others being 100nF, 10nF and 1nF), polyester caps should be used throughout.

<p><b><small>In case you are not familiar with scientific notation for component values, 10,000 is 10 * 10<sup>3</sup> and 1uF (micro-Farad) is 1 * 10<sup>-6</sup> Farad. 1nF (nano-Farad) is 1 * 10<sup>-9</sup>. All capacitances are in Farads, and resistors are in Ohms.</small></b>
<p>Rfb1 and Rfb2 must be carefully selected to provide a gain of exactly 3 (the loss in the phase-shift network). Since this is not possible in real life (due to component tolerances and other problems), some form of amplitude stabilisation is needed to ensure that the gain is automatically corrected. More on this subject below.

<p>Some care is needed to minimise stray capacitance, since 100pF of stray will create a 10% error on the highest frequency range. No special precautions are needed, but keeping all leads as short as possible helps, and don't try to make the frequency range switching really neat (with all the caps nicely arranged), since this will add stray capacitance.</p>

<hr><b>Amplitude Stabilisation Circuit</b>
<p>This should be really simple, but this is no longer the case. STC (and others) used to make an NTC (Negative Temperature Coefficient) thermistor - the RA53 (or R53), and I could find no-one who supplies this part any more. The unit is (was!) a directly heated glass encapsulated bead type, with a response time that is fast enough to be usable, but not so fast as to cause low frequency distortion. This particular device has been used in hundreds of audio oscillator circuits over the years, but now we need to use something different to keep the cost down.

<p>There are a number of possibilities, outlined below (best to worst) ...</p>

<ul>
  <li><b>Thermistor</b> - the RA53 or R53 NTC thermistor appears unobtainable, but the RA54 is still available - but at AU$30 these do not really represent good value. There appear to be no suitable PTC (Positive Temperature Coefficient) thermistors currently available for this application. An NTC thermistor is used in place of Rfb1.<br><br>
  <li><b>Low Power Lamp</b> - If a suitably small lamp can be found, this works quite well as a PTC thermistor. This is one of the possibilities offered, and works rather well. The filament of the lamp has a positive temperature coefficient, but requires more power than the thermistor. This is use in place of Rfb2.<br><br>
  <li><b>LDR</b> - A Light Dependent Resistor has a very high voltage limit before distortion, and can produce very good results. Although it requires more additional circuitry than the thermistor or lamp, the result is worth the effort. The LDR can be used as either Rfb1 or Rfb2, but it is more convenient to use it for Rfb2 - the circuit is simpler, an the voltage across the device is minimised.<br><br>
  <li><b>FET</b> - A Field Effect Transistor works quite well as a voltage controlled resistor, but has a limited peak voltage, so the level must be kept below 1V if distortion is to remain within respectable limits. This is barely acceptable for the output of this oscillator. A FET circuit was considered and discarded.<br><br>
  <li><b>VCA</b> - There are a number of Voltage Controlled Amplifiers available, but circuit complexity and limited maximum voltage make these unattractive for a simple circuit.
</ul>

<p>Since the NTC (Negative Temperature Coefficient) RA54 (or R54) thermistor was AU$30 when you could get them, this option is sadly eliminated for the vast majority of constructors - availability is now almost zero.

<p>The alternative option shown uses a lamp - not ideal, but they do work and will suit the purpose very well. The lamp is a nuisance because of the extra power it needs, but such is life.

<p>The NTC thermistor works by the rather simple method of decreasing its resistance as the signal level rises. Since it is located in the feedback path (as Rfb1), this increases the amount of applied feedback, thus reducing the gain. Should the gain fall, the resistance of the thermistor increases again (less available voltage, less current, so less heating of the thermistor bead). This naturally causes the gain to rise again.

<p>A lamp (having a PTC), requires a re-arrangement of the feedback path, so it will perform the same function. The lamp stabiliser is connected as Rfb2.

<p>One irritating habit of the thermistor (or lamp) stabilisation is that the output voltage "bounces" whenever the frequency is changed. One gets used to this, and ultimately it is worth it for the low distortion available. There are many "synthesised" sine-wave generators (I have one of them, too), and while they are fine for performing a quick test, the distortion is too high to be useful for serious measurements. This bounce will also be apparent on the LDR version, since again, improving the speed will cause an unacceptable increase in low frequency distortion.

<p>For what it's worth, the main cause of amplitude bounce is small tracking errors in the pot used to set the frequency. As the pot is turned, the two resistances do not remain exactly equal - this upsets the circuit gain and the bounce occurs as the stabilisation network compensates for the change.

<p>One of the most important aspects of the stabilisation circuit is that it must be slow enough to prevent the shape of low frequency waveforms from being altered. This would introduce considerable distortion at low frequencies, and it is the slow response time that is responsible for the waveform bounce.</p>

<hr><b>Lamp Stabilised Wien Bridge Oscillator</b>
<p>The circuit for the oscillator itself remains unchanged for all options (other than the feedback path), since once a suitable design is found, there is no real need to change it. Unfortunately, use of batteries is not recommended due to the current drain of the Class-AB output stage, so the AC power supply is a necessity.

<p>Figure 2 shows the oscillator itself, with the lamp stabiliser. The frequency range switching is done with a 4 position, 2 pole rotary switch, and the capacitors should be wired directly to the switch to minimise stray capacitance.</p>

<p align="center"><img SRC="p22_fig2.gif" ALT="Figure 2" BORDER=1>
<br><b><small>Figure 2 - Lamp Stabilised Wien Bridge Oscillator</small></b></p>

<p>The circuit is a low power version of a simple power amplifier, and will provide the necessary 3.16V RMS easily using a +/-12V supply. Peak amplitude is about +/- 4.5V, and a simple emitter follower buffer is used to drive the output voltage divider (see below for level control, buffer and output attenuator).

<p>Current in the output stage and buffer is quite high at 8mA, and a small heatsink is a good idea for the output devices (those with the 33 Ohm emitter resistors). They will be dissipating about 100mW each under normal operating conditions with a +/- 12V supply. Likewise, heatsinks should be used on the power supply regulators (these are normally not needed when powering a few conventional opamps). The diodes shown are 1N4001 or similar. Resistors are all 1/4 Watt 1% tolerance metal film, and a cermet multi-turn pot is recommended for the 500 Ohm variable resistor.</p>

<p align="center"><img SRC="p22_fig3.gif" alt="Figure 3" BORDER=1>
<br><b><small>Figure 3 - Typical 12V/50mA Lamp Characteristics</small></b></p>

<p>Figure 3 shows the average measured response of 4 typical 12V 50mA 'Grain of Wheat' lamps. The result is a non-linear resistance, which increases with increasing current (positive temperature coefficient). This is what we want, but as can be seen, the resistance is rather low, and a useful response is only achieved with a current of above 6mA. Typically, with 1.05V across the lamp and series resistor (3.16V output) the lamp resistance will be in the order of 60 Ohms or so, add the 47 Ohm resistor in series giving a total of 107 Ohms. Since the feedback resistance needs to be double this value, the pot will be set to 214 - 47 = 167 Ohms. These are all very low impedances, and this is the reason that the output stage needs to be able to supply more current than normal.</p>

<hr><b>Level Control And Attenuator</b>
<p>Figure 4 shows the circuit for the level control, buffer and attenuator. The buffer stage is used to ensure that the impedance seen by the attenuator is low, regardless of the pot setting. This arrangement is not as elegant as some others I have seen, but is quite acceptable and  introduces little distortion. The loss introduced by this stage is about 0.05dB, which can be considered negligible.</p>

<p align="center"><img SRC="p22_fig4.gif" alt="Figure 4" BORDER=1>
<br><b><small>Figure 4 - Level Control And Attenuator</small></b></p>

<p>The level control is a single gang linear pot, and as shown, the attenuator provides a passably constant output impedance of 560 Ohms at all output settings. If desired, the output can be calibrated in Volts, with the ranges 3V, 300mV, 30mV and 3mV. Attenuator accuracy is very good, provided 1% resistors are used for all ranges.

<p>The BC559 transistor will need a small heatsink, as it is operating at a current of about 12mA, so dissipation is 140mW.

<p>The electrolytic capacitors should ideally be low leakage types, and can be low voltage. The input is taken directly from the output of the oscillator, which means that there is a small DC voltage across the 10k pot. This might make the pot a little noisy, but it should be quite acceptable.</p>

<hr><b>Square Wave Generator</b>
<p>There are many ways to create a square wave output, but by far the simplest is to use a CMOS Hex Schmitt trigger inverter. These are fast, and with the outputs in parallel, will provide enough drive to ensure that the rise and fall times are very short indeed.

<p>It is very important that you get the 4584 or 74C14 version of the hex Schmitt, because if you use the 74HC14 the 12V supply will destroy it instantly. It is also important to use the switching as shown, because if the square wave converter is left running all the time it will introduce switching spikes into the sine wave.</p>

<p align="center"><img SRC="p22_fig5.gif" ALT="Figure 5" BORDER=1>
<br><b><small>Figure 5 - Optional Square Wave Converter</small></b></p>

<p>The output of this circuit is from 0V to +12V, and is fed to the 10k level pot by a 10k resistor. This reduces the level to 6V P-P, which is equal to 3V RMS. The input circuit is designed to ensure that the Schmitt input is supplied from a 1/2 supply voltage (6V), so the applied AC will swing evenly about this point and produce a symmetrical square wave.

<p>The view of the IC is from the top, with the dot indicating pin 1. In case anyone was wondering why I used the "picture" of the IC instead of a schematic, its because it was easier (and smaller). I don't have a Schmitt trigger schematic in my library, and was too lazy to build one.

<p>The switch is a double-pole, double throw (DPDT) type - a slide switch or mini-toggle are equally suitable. As is (hopefully) apparent, this circuit goes between the oscillator and the level control and buffer of Figure 4.</p>

<hr><b>Construction And Calibration</b>
<p>The construction is not overly critical, but do remember the heatsinks for the output transistors of the oscillator and the buffer stage. Because of the simplicity of the circuit, it should pose no difficulties in construction.

<p>The only tricky part is the frequency dial. There are a number of ways to do this, and the easiest is to reproduce the scale shown below, and stick it onto a disk of aluminium or fibreglass (or an old CD - you will need to resize either the CD or the image though). You then need to attach a suitable knob in the centre, using epoxy glue or small screws from the rear. The "pointer" can be as simple or elaborate as you like - mine uses a small piece of perspex with a line scribed on the rear, supported just above the dial.</p>

<p align="center"><img SRC="p22_fig6.gif" ALT="Figure 6" BORDER=1>
<br><b><small>Figure 6 - The Frequency Dial</small></b></p>

<p>Notice that the frequency scale runs backwards, so that the pot will be wired in the 'normal' fashion, with minimum resistance at the fully anti-clockwise position. Since minimum resistance is maximum frequency, this works out the way it should. The pointer is expected to be on the right hand side of the scale, otherwise the lettering will be upside down (or vertical) for the wanted frequency.

<p>Unfortunately, the image scanned from my unit was fairly scungy, so I have had to do a reproduction. This is not perfect either, but it will still look better than hand lettering. The image shown is fairly good, but if you want a better one, you'll have to do it yourself. The two unmarked pointers should coincide with the limits of travel of the pot, so if you have no other method of calibration, this should get you into the ball park. However ...</p>

<p><b>Calibration</b>
<p>Calibration is the next step. If you have access to a frequency meter, then you have no problems, but without one all you can do is hope for the best from one range to the next, having calibrated by ear from the mains supply (using a small transformer to generate a suitable voltage), or just used the pot travel markers on the dial.

<p>If you have a 12V transformer, connect one secondary output to the oscillator's earth point, and connect the other via a 4.7k resistor to the output. Set the output to the 3V or +10dB range, but keep the level turned down. Set the frequency range to 15Hz, and the variable control to 100Hz (or 120Hz if you are in the US or anywhere else 60Hz is used).

<p>Using a set of headphones, you should be able to hear the 50 (or 60) Hz hum softly. Now increase the oscillator level control, and a second tone should be audible. Adjust the frequency control slowly until the two tones are "in tune", at which point you should hear the 50/60 Hz and its second harmonic. The level should be stable - you will hear the signal "beat" as you move the frequency control slightly high or low.

<p>It is possible to tune to an accuracy of 0.1% using this method. Once the perfect second harmonic is found, you need to rotate the knob on the pot shaft - without moving the shaft - until the pointer is exactly on the 100Hz (or 120Hz) mark on the dial.</p>

<hr><b>Thermistor Stabilised Version</b>
<p>The thermistor stabilised unit is very similar to the lamp stabilised version above, but can be expected to have better distortion figures at low frequencies. There is more amplitude bounce with the thermistor because it has a longer thermal time-constant, but this contributes to its lower distortion.</p>

<p align="center"><img SRC="p22_fig7.gif" ALT="Figure 7" BORDER=1>
<br><b><small>Figure 7 - Thermistor Stabilised Circuit</small></b></p>

<p>As can be seen, it is very similar to the previous circuit, but the feedback impedance is higher. This will also help lower the circuit's distortion, but as I stated earlier, the thermistor is almost impossible to get.  It used to be advertised in a Farnell Components, but no longer. Same with RS Components and any other supplier that I could find. It has to be accepted that these thermistors are unavailable other than by accident.

<p>Back in 1999, a reader sent me some information, including a part number from RS Components. Farnell also stocked the RA54 (you don't want to know the price). Unfortunately, both suppliers have dropped the RA53 and RA54 thermistors, nor does either have any equivalent. The only viable option now is to use a lamp.</p>

<hr />
<center>&nbsp;
<script type="text/javascript"><!--
google_ad_client = "pub-1947877433449191";
/* 468x60, created 20/08/10 */
google_ad_slot = "7119701939";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>

<hr /><a href="projects.htm" OnMouseOver="document.b1.src='arrow.gif';" OnMouseOut="document.b1.src='a1.gif';">
<img src="a1.gif" name="b1" alt="Index" border=0 height=24 width=40></a><b>Projects Index</b>
<br><a href="index2.html" OnMouseOver="document.b3.src='a.gif';" OnMouseOut="document.b3.src='a1.gif';">
<img src="a1.gif" name="b3" alt="ESP Home" border=0></a><b>Main Index</b><br /><br />

<table BORDER BGCOLOR="black">
<tr><td class="t-wht"><a id="copyright"></a><b>Copyright Notice.</b> This article, including but not limited to all text and diagrams, is the intellectual property of Rod Elliott, and is Copyright (c) 1999. Reproduction or re-publication by any means whatsoever, whether electronic, mechanical or electro- mechanical, is strictly prohibited under International Copyright laws. The author (Rod Elliott) grants the reader the right to use this information for personal use only, and further allows that one (1) copy may be made for reference while constructing the project. Commercial use is prohibited without express written authorisation from Rod Elliott.</td></tr></table>
<div class="t-sml">Last Updated 01 Nov 1999./ 12 April 2010 - removed all references to thermistor suppliers as they are no longer stocked by anyone I could find.</div>
</body>
</html>
