<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="start" title="Site Top" href="../../index_j.html">
<link rel="up" title="Tech Notes" href="../../cc.html">
<link rel="next" title="ノイズ対策" href="te02.html">
<link rel="stylesheet" href="../docs.css" type="text/css" media="screen" title="ELM Default">
<title>ELM - 接点入力と処理のコツ - チャタリング対策</title>
</head>

<body>
<h1>チャタリング対策のしかた</h1>
<p class="hdd"><br>2002. 1. 30</p>
<hr class="hds">

<div class="abst">
<img class="rset" src="te01.png" alt="" width="402" height="143">
<p>接点入力の処理において常につきまとう問題として、<em>チャタリング</em>があげられます。チャタリングとは、機械接点がOFF→ONまたはON→OFFへ移行する際、瞬時に変化するのではなく、ON/OFFを何回か繰り返しながら状態が移行する現象のことです。</p>
<p>チャタリングの継続時間は、数100μs〜数msと人間から見ればほんの一瞬のことで感知することはできませんが、高速な電子回路にとっては次のようなイメージでとらえられていることでしょう。まず、ONするときは接点同士が衝突した瞬間一度では安定せず、ボールがバウンドするように暴れながら最終的に接触状態に落ち着きます。また、OFFするときは接触圧が徐々に弱まり、接触不良状態になりながら接点が離れてゆきます。</p>
<p><small>NOTE: チャタリング(chattering)には、震えて歯がカチカチいう、また機械が同様の音を立てるという意味がある。</small></p>
</div>


<div class="para">
<h3>チャタリングの害</h3>
<img class="rset" src="te02.png" alt="" width="488" height="126">
<p>たとえば、右の図のように接点入力をカウンタのクロックとしてそのまま使うとどうなるでしょうか。１回押しただけでカウントがいくつも進んでしまい意図した動作をしません。このように、電子回路はチャタリングを複数回の接点動作として捉えてしまうのです。</p>
<p>チャタリングの継続時間は接点支持機構の造りにより異なり、だいたい次のような感じです。</p>
<h4>チャタリングの短いもの（1ms以下）</h4>
<ul>
<li>水銀スイッチ・リレー（チャタリング無し）</li>
<li>タクトスイッチ</li>
<li>小型トグルスイッチ</li>
</ul>
<h4>チャタリングの長いもの（〜10ms）</h4>
<ul>
<li>リレー（特にｂ接点が長い）</li>
<li>マイクロスイッチ</li>
<li>古いスイッチ（特に摺動接点の場合、数10msにわたって発生する場合がある）</li>
</ul>
</div>


<div class="para">
<h3>非インテリジェント系での対策方法</h3>
<img class="rset" src="te03.png" alt="" width="368" height="128">
<p>さて、チャタリングの正体が分かったところでそれの対策といきましょう。簡単な対策として、右図のようなCRフィルタの挿入が一般的に用いられています。チャタリングによる高速な断続はフィルタにより平滑され除去されます。ただし、フィルタにより波形が鈍るので必要に応じてシュミット・トリガなどで波形整形してやる必要があります。</p>
</div>


<div class="para">
<h3>マイコンシステムでの対策方法</h3>
<p>マイコンの入力ポートへ接続される場合は、付加回路を省いて代わりにプログラムによる処理でチャタリングの影響を回避します。</p>

<h4>ディレイ方式</h4>
<img class="lset" src="te04.png" alt="" width="355" height="99">
<p>簡単なので単純なプログラムで用いられることがあります。まず、接点の状態を監視して、変化したら一定時間待ってもう一度読み込みます。そのとき再び同じ状態が読み込まれたらその変化を有効とみなして相応の処理へ移ります。しかし、プロセッサの有効利用の観点からすると良くない方式ですので、ごく単純なものを除いてあまり用いられていません。</p>

<h4>サンプリング方式</h4>
<img class="lset" src="te05.png" alt="" width="413" height="110">
<p>実際の組み込み用途ではこの方式が通常よく用いられます。接点の状態はタイマー割り込みなどにより一定時間ごとにサンプルされメモリに格納されます。サンプリングの周期をチャタリング継続時間より十分長くとれば、メモリ上の値はチャタリングの影響を受けないことになります。接点の状態を調べるときはポートは読まずに、そのメモリの値を参照するようにします。プログラムループ中でスイッチ状態の参照が間欠的に行われるような処理とすれば、メモリに保持しておく必要は無いとも言えます。</p>
<p>サンプリング周期はスイッチの特性にもよりますが、一般的に10ms(100Hz)程度です。必要に応じてノイズキャンセル処理（次のセクションで解説）も組み合わせて使用されます。</p>
</div>

<p class="foot"><a href="../../cc.html">戻る</a> | <a href="te02.html">次</a></p>

</body>
</html>
